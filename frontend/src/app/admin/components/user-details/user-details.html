<div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto">
  <!-- Header Section -->
  <div class="flex flex-col space-y-4 md:flex-row md:justify-between md:items-center md:space-y-0 mb-6">
    <div class="space-y-1">
      <h1 class="text-3xl font-bold tracking-tight text-gray-800 dark:text-white">User Details</h1>
      <p class="text-sm text-gray-600 dark:text-gray-400">
        View and manage user information
      </p>
    </div>

    <nav class="flex" aria-label="Breadcrumb">
      <ol class="inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse">
        <li class="inline-flex items-center">
          <a routerLink="/"
            class="inline-flex items-center text-sm font-medium text-gray-800 dark:text-gray-400 dark:hover:text-white hover:text-blue-600">
            <svg class="flex-shrink-0 w-4 h-4 me-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
              viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round">
              <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
              <polyline points="9 22 9 12 15 12 15 22" />
            </svg>
            Home
          </a>
        </li>
        <li>
          <div class="flex items-center">
            <svg class="flex-shrink-0 w-4 h-4 text-gray-400 mx-2 rtl:rotate-180" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6" />
            </svg>
            <a routerLink="/admin"
              class="text-sm font-medium text-gray-800 dark:text-gray-400 dark:hover:text-white hover:text-blue-600">Admin</a>
          </div>
        </li>
        <li>
          <div class="flex items-center">
            <svg class="flex-shrink-0 w-4 h-4 text-gray-400 mx-2 rtl:rotate-180" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6" />
            </svg>
            <a routerLink="/admin/users"
              class="text-sm font-medium text-gray-800 dark:text-gray-400 dark:hover:text-white hover:text-blue-600">Users</a>
          </div>
        </li>
        <li aria-current="page">
          <div class="flex items-center">
            <svg class="flex-shrink-0 w-4 h-4 text-gray-400 mx-2 rtl:rotate-180" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6" />
            </svg>
            <span class="text-sm font-medium text-gray-500 dark:text-gray-500">Details</span>
          </div>
        </li>
      </ol>
    </nav>
  </div>

  <div *ngIf="loading" class="text-center p-6">
    <div class="animate-spin inline-block w-6 h-6 border-[3px] border-current border-t-transparent text-blue-600 rounded-full"
      role="status" aria-label="loading">
      <span class="sr-only">Loading...</span>
    </div>
    <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">Loading user details...</p>
  </div>

  <div *ngIf="error"
    class="bg-red-50 border border-red-200 text-sm text-red-800 rounded-lg p-4 dark:bg-red-800/30 dark:border-red-900 dark:text-red-500"
    role="alert">
    <div class="flex">
      <div class="flex-shrink-0">
        <svg class="flex-shrink-0 h-4 w-4 mt-0.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
          viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round">
          <circle cx="12" cy="12" r="10" />
          <path d="M12 16v-4" />
          <path d="M12 8h.01" />
        </svg>
      </div>
      <div class="ms-4">
        <h3 class="text-sm font-semibold">
          Error loading user details
        </h3>
        <p class="mt-0.5 text-sm">
          {{ error }}
        </p>
      </div>
    </div>
  </div>

  <div *ngIf="user && !loading && !error" class="bg-white border border-gray-200 rounded-xl shadow-sm dark:bg-slate-900 dark:border-gray-700">
    <div class="p-4 sm:p-7">
      <div class="flex items-center gap-x-4 mb-6">
        <div
          class="flex-shrink-0 h-16 w-16 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-600 dark:text-gray-300 text-2xl font-semibold">
          {{ user.name.charAt(0).toUpperCase() }}
        </div>
        <div>
          <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">{{ user.name }}</h2>
          <p class="text-sm text-gray-600 dark:text-gray-400">{{ user.email }}</p>
        </div>
      </div>

      <div class="border-b border-gray-200 dark:border-gray-700">
        <nav class="flex space-x-2" aria-label="Tabs" role="tablist">
          <button type="button"
            class="hs-tab-active:font-semibold hs-tab-active:border-blue-600 hs-tab-active:text-blue-600 py-4 px-1 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-blue-600 disabled:opacity-50 disabled:pointer-events-none dark:text-gray-400 dark:hover:text-blue-500 active"
            id="profile-tab" data-hs-tab="#profile" aria-controls="profile" role="tab">
            <svg class="flex-shrink-0 w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            Profile
          </button>
          <button type="button"
            class="hs-tab-active:font-semibold hs-tab-active:border-blue-600 hs-tab-active:text-blue-600 py-4 px-1 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-blue-600 disabled:opacity-50 disabled:pointer-events-none dark:text-gray-400 dark:hover:text-blue-500"
            id="parcels-tab" data-hs-tab="#parcels" aria-controls="parcels" role="tab">
            <svg class="flex-shrink-0 w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-package"><path d="m7.5 4.27 9 5.15"/><path d="M2.5 8.67 12 14l9.5-5.33"/><path d="m7.5 19.73 9-5.15"/><path d="M12 22V14"/><path d="M2.5 15.33 12 20.67l9.5-5.34"/></svg>
            Parcels
          </button>
          <button type="button"
            class="hs-tab-active:font-semibold hs-tab-active:border-blue-600 hs-tab-active:text-blue-600 py-4 px-1 inline-flex items-center gap-x-2 border-b-2 border-transparent text-sm whitespace-nowrap text-gray-500 hover:text-blue-600 disabled:opacity-50 disabled:pointer-events-none dark:text-gray-400 dark:hover:text-blue-500"
            id="notifications-tab" data-hs-tab="#notifications" aria-controls="notifications" role="tab">
            <svg class="flex-shrink-0 w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bell"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>
            Notifications
          </button>
        </nav>
      </div>

      <div class="mt-5">
        <div id="profile" role="tabpanel" aria-labelledby="profile-tab">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200">Profile Information</h3>
            <button *ngIf="!isEditing" (click)="toggleEditMode()" type="button"
              class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none">
              <svg class="flex-shrink-0 w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M12 20h9" />
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" />
              </svg>
              Edit
            </button>
          </div>

          <div *ngIf="!isEditing" class="grid sm:grid-cols-2 gap-4">
            <div>
              <p class="text-sm text-gray-500">Name:</p>
              <p class="text-gray-800 dark:text-gray-200">{{ user.name }}</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Email:</p>
              <p class="text-gray-800 dark:text-gray-200">{{ user.email }}</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Phone:</p>
              <p class="text-gray-800 dark:text-gray-200">{{ user.phone || 'N/A' }}</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Address:</p>
              <p class="text-gray-800 dark:text-gray-200">{{ user.address || 'N/A' }}</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Roles:</p>
              <div class="flex flex-wrap gap-1">
                <span *ngFor="let role of user.role"
                  class="inline-flex items-center gap-x-1.5 py-1.5 px-3 rounded-full text-xs font-medium"
                  [ngClass]="{
                    'bg-blue-100 text-blue-800 dark:bg-blue-800/30 dark:text-blue-500': role === 'ADMIN',
                    'bg-green-100 text-green-800 dark:bg-green-800/30 dark:text-green-500': role === 'USER',
                    'bg-purple-100 text-purple-800 dark:bg-purple-800/30 dark:text-purple-500': role === 'PREMIUM_USER'
                  }">
                  {{ role }}
                </span>
              </div>
            </div>
            <div>
              <p class="text-sm text-gray-500">Status:</p>
              <span class="inline-flex items-center gap-x-1.5 py-1.5 px-3 rounded-full text-xs font-medium"
                [ngClass]="{
                  'bg-green-100 text-green-800 dark:bg-green-800/30 dark:text-green-500': user.isActive,
                  'bg-red-100 text-red-800 dark:bg-red-800/30 dark:text-red-500': !user.isActive
                }">
                <svg class="w-2.5 h-2.5"
                  [ngClass]="{
                    'fill-green-500': user.isActive,
                    'fill-red-500': !user.isActive
                  }" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="8" cy="8" r="8" />
                </svg>
                {{ user.isActive ? 'Active' : 'Inactive' }}
              </span>
            </div>
          </div>

          <div *ngIf="isEditing" class="mt-4">
            <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
              <div class="grid sm:grid-cols-2 gap-4">
                <div class="col-span-full">
                  <label for="name" class="inline-block text-sm font-medium text-gray-800 dark:text-gray-200 mt-2.5">Name</label>
                  <input type="text" id="name" formControlName="name"
                    class="py-2 px-3 pe-11 block w-full border-gray-200 shadow-sm rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400 dark:focus:ring-gray-600">
                  <div *ngIf="profileForm.get('name')?.invalid && profileForm.get('name')?.touched" class="text-red-500 text-xs mt-1">
                    Name is required.
                  </div>
                </div>

                <div class="col-span-full">
                  <label for="email" class="inline-block text-sm font-medium text-gray-800 dark:text-gray-200 mt-2.5">Email</label>
                  <input type="email" id="email" formControlName="email"
                    class="py-2 px-3 pe-11 block w-full border-gray-200 shadow-sm rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400 dark:focus:ring-gray-600">
                  <div *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" class="text-red-500 text-xs mt-1">
                    Valid email is required.
                  </div>
                </div>

                <div class="col-span-full">
                  <label for="phone" class="inline-block text-sm font-medium text-gray-800 dark:text-gray-200 mt-2.5">Phone</label>
                  <input type="text" id="phone" formControlName="phone"
                    class="py-2 px-3 pe-11 block w-full border-gray-200 shadow-sm rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400 dark:focus:ring-gray-600">
                  <div *ngIf="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched" class="text-red-500 text-xs mt-1">
                    Phone is required.
                  </div>
                </div>

                <div class="col-span-full">
                  <label for="address" class="inline-block text-sm font-medium text-gray-800 dark:text-gray-200 mt-2.5">Address</label>
                  <input type="text" id="address" formControlName="address"
                    class="py-2 px-3 pe-11 block w-full border-gray-200 shadow-sm rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400 dark:focus:ring-gray-600">
                </div>

                <div class="col-span-full">
                  <label for="dateOfBirth" class="inline-block text-sm font-medium text-gray-800 dark:text-gray-200 mt-2.5">Date of Birth</label>
                  <input type="date" id="dateOfBirth" formControlName="dateOfBirth"
                    class="py-2 px-3 pe-11 block w-full border-gray-200 shadow-sm rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-700 dark:text-gray-400 dark:focus:ring-gray-600">
                </div>

                <div class="col-span-full text-center">
                  <app-image-upload [imageUrl]="profileForm.get('avatarUrl')?.value"
                    (imageUrlChange)="profileForm.get('avatarUrl')?.setValue($event)"
                    (uploadError)="toastService.error('Upload Failed', $event)">
                  </app-image-upload>
                </div>
              </div>

              <div class="mt-5 flex justify-end gap-x-2">
                <button type="button" (click)="cancelEdit()"
                  class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-slate-900 dark:border-gray-700 dark:text-white dark:hover:bg-gray-800">
                  Cancel
                </button>
                <button type="submit" [disabled]="profileForm.invalid"
                  class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none">
                  Save changes
                </button>
              </div>
            </form>
          </div>
        </div>

        <div id="parcels" class="hidden" role="tabpanel" aria-labelledby="parcels-tab">
          <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">User Parcels</h3>
          <div class="bg-blue-50 border border-blue-200 text-sm text-blue-800 rounded-lg p-4 dark:bg-blue-800/30 dark:border-blue-900 dark:text-blue-500"
            role="alert">
            <div class="flex">
              <div class="flex-shrink-0">
                <svg class="flex-shrink-0 h-4 w-4 mt-0.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round">
                  <path d="M12 22c-4.418 0-8-3.582-8-8V4h16v10c0 4.418-3.582 8-8 8z" />
                  <path d="M12 6v8" />
                </svg>
              </div>
              <div class="ms-4">
                <h3 class="text-sm font-semibold">
                  Coming Soon!
                </h3>
                <p class="mt-0.5 text-sm">
                  Parcel details and history for this user will be available here soon.
                </p>
              </div>
            </div>
          </div>
        </div>

        <div id="notifications" class="hidden" role="tabpanel" aria-labelledby="notifications-tab">
          <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4">User Notifications</h3>
          <div class="bg-blue-50 border border-blue-200 text-sm text-blue-800 rounded-lg p-4 dark:bg-blue-800/30 dark:border-blue-900 dark:text-blue-500"
            role="alert">
            <div class="flex">
              <div class="flex-shrink-0">
                <svg class="flex-shrink-0 h-4 w-4 mt-0.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round">
                  <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" />
                  <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" />
                </svg>
              </div>
              <div class="ms-4">
                <h3 class="text-sm font-semibold">
                  Coming Soon!
                </h3>
                <p class="mt-0.5 text-sm">
                  Notification preferences and history for this user will be available here soon.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>