<div class="flex h-screen bg-background">
    <!-- Sidebar -->
    <div [class]="sidebarClasses()">
        <!-- Logo/Brand -->
        <div class="flex items-center gap-2 px-4 py-3 border-b border-border">
            <div class="flex items-center justify-center w-8 h-8 bg-primary rounded-lg">
                <svg class="w-5 h-5 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
            </div>
            <span [class]="logoTextClasses()">Acme Inc</span>
        </div>
        <!-- Navigation -->
        <nav class="flex-1 px-3 py-4 space-y-1 overflow-y-auto">
            <ng-container *ngFor="let item of items$ | async">
                <div class="space-y-1">
                    <!-- Main Navigation Item -->
                    <a *ngIf="!item.children || !item.collapsible" [routerLink]="item.route"
                        routerLinkActive="bg-accent text-accent-foreground" [class]="getNavItemClasses(item)">
                        <span *ngIf="item.icon" class="material-symbols-outlined mr-2">{{ item.icon }}</span>
                        <span [class]="navTextClasses()">{{ item.label }}</span>
                    </a>
                    <!-- Collapsible Section -->
                    <ng-container *ngIf="item.children && item.collapsible">
                        <button (click)="toggleSection(item.label)" [class]="getNavItemClasses(item)">
                            <div class="flex items-center">
                                <span *ngIf="item.icon" class="material-symbols-outlined mr-2">{{ item.icon }}</span>
                                <span [class]="navTextClasses()">{{ item.label }}</span>
                            </div>
                            <span class="material-symbols-outlined transition-transform duration-300"
                                [class.rotate-90]="!isCollapsed(item.label)">
                                expand_more
                            </span>
                        </button>
                        <div *ngIf="!isCollapsed(item.label)" class="ml-4 mt-1 space-y-1 transition-all">
                            <a *ngFor="let child of item.children" [routerLink]="child.route"
                                routerLinkActive="bg-accent text-accent-foreground" [class]="getSubNavItemClasses()">
                                <span [class]="navTextClasses()">{{ child.label }}</span>
                            </a>
                        </div>
                    </ng-container>
                </div>
            </ng-container>
        </nav>
        <!-- User Profile -->
        <div class="border-t border-border p-3">
            <div [class]="userProfileClasses()">
                <img [src]="authService.currentUserValue?.avatarUrl || 'https://github.com/shadcn.png'"
                    [alt]="authService.currentUserValue?.name" class="w-8 h-8 rounded-full" />
                <div [class]="userInfoClasses()">
                    <p class="text-sm font-medium leading-none">{{ authService.currentUserValue?.name }}</p>
                    <p class="text-xs leading-none text-muted-foreground">{{ authService.currentUserValue?.email }}</p>
                </div>
            </div>
        </div>

    </div>
    <!-- Toggle Button -->
    <button (click)="toggleSidebar()"
        class="fixed top-4 left-4 z-50 flex items-center justify-center w-8 h-8 bg-background border border-border rounded-md shadow-md hover:bg-accent lg:hidden">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
    </button>
    <!-- Overlay for mobile -->
    <div *ngIf="isMobileMenuOpen()" class="fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden"
        (click)="closeMobileSidebar()"></div>
</div>